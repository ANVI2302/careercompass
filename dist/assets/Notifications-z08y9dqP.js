import{a as C,p as _,r as m,j as e,s as M}from"./index-DLvctgip.js";import{a as l}from"./api-CZvb7fD7.js";import{C as p,c as f}from"./card-Hcr5LphZ.js";import{B as A}from"./button-CC9hluON.js";import{B as y}from"./bell-CYKXf6G1.js";import{A as g}from"./alert-circle-BHhzpVRp.js";import{C as E}from"./check-CQtoMY4e.js";import{c as R}from"./createLucideIcon-BOVikoT8.js";import"./index-yXHGKZkG.js";/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=R("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function q(){const{token:r}=C(),{toast:d}=_(),[i,n]=m.useState([]),[b,N]=m.useState(!0),[c,o]=m.useState(0),[x,u]=m.useState(null);m.useEffect(()=>{if(!r)return;const t=async()=>{try{u(null);const s=await l.getNotifications(r);n(s.notifications||[]),o(s.unread_count||0)}catch(s){const h="Failed to load notifications";u(h),console.error(h,s)}finally{N(!1)}};t();const a=setInterval(t,3e4);return()=>clearInterval(a)},[r]);const j=async t=>{if(r)try{n(i.map(a=>a.id===t?{...a,is_read:!0}:a)),o(Math.max(0,c-1)),await l.markNotificationsRead(r,[t]),d({title:"Marked as read",description:"Notification marked as read successfully"})}catch(a){console.error("Failed to mark as read:",a),d({title:"Error",description:"Could not mark notification as read",variant:"destructive"});const s=await l.getNotifications(r);n(s.notifications||[]),o(s.unread_count||0)}},v=async t=>{if(r)try{const a=i.find(s=>s.id===t);n(i.filter(s=>s.id!==t)),a&&!a.is_read&&o(Math.max(0,c-1)),await l.deleteNotification(r,t),d({title:"Deleted",description:"Notification deleted successfully"})}catch(a){console.error("Failed to delete notification:",a),d({title:"Error",description:"Could not delete notification",variant:"destructive"});const s=await l.getNotifications(r);n(s.notifications||[]),o(s.unread_count||0)}},k=async()=>{if(!(!r||c===0))try{const t=i.filter(a=>!a.is_read).map(a=>a.id);n(i.map(a=>({...a,is_read:!0}))),o(0),await l.markNotificationsRead(r,t),d({title:"All marked as read",description:"All notifications marked as read"})}catch(t){console.error("Failed to mark all as read:",t),d({title:"Error",description:"Could not mark all as read",variant:"destructive"});const a=await l.getNotifications(r);n(a.notifications||[]),o(a.unread_count||0)}},w=t=>{switch(t){case"achievement":return"bg-amber-900 text-amber-200";case"mentorship":return"bg-purple-900 text-purple-200";case"course_recommendation":return"bg-green-900 text-green-200";case"connection_request":return"bg-blue-900 text-blue-200";default:return"bg-gray-700 text-gray-200"}};return b?e.jsx(M,{}):e.jsxs("div",{className:"container max-w-screen-2xl p-6 lg:p-12 space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-cyan-700 pb-8",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-white mb-2 flex items-center gap-3",children:[e.jsx(y,{className:"w-8 h-8 text-cyan-400"}),"Notifications"]}),e.jsx("p",{className:"text-cyan-200 text-sm",children:"Stay updated with your activities and achievements"})]}),c>0&&e.jsx(A,{onClick:k,className:"bg-cyan-600 hover:bg-cyan-700 text-white font-semibold h-10 px-6",children:"Mark All as Read"})]}),x&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 text-red-300 p-4 rounded-lg flex items-center gap-3",children:[e.jsx(g,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:x})]}),c>0&&e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 text-blue-300 p-4 rounded-lg flex items-center gap-3",children:[e.jsx(g,{className:"h-5 w-5"}),e.jsxs("span",{className:"text-sm",children:["You have ",e.jsx("strong",{children:c})," unread notification",c!==1?"s":""]})]}),i.length===0?e.jsx(p,{className:"bg-blue-800/50 border-cyan-700",children:e.jsxs(f,{className:"pt-12 pb-12 text-center",children:[e.jsx(y,{className:"w-16 h-16 text-gray-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-300 text-lg font-medium",children:"No notifications yet"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"You'll see your notifications here as you progress"})]})}):e.jsx("div",{className:"space-y-4",children:i.map(t=>e.jsx(p,{className:`border-l-4 transition-all ${t.is_read?"bg-blue-800/30 border-l-gray-600":"bg-blue-800/50 border-l-cyan-400"}`,children:e.jsx(f,{className:"pt-6 pb-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:`text-xs px-2.5 py-1 rounded font-semibold ${w(t.type)}`,children:t.type.replace(/_/g," ").toUpperCase()}),!t.is_read&&e.jsx("span",{className:"w-2 h-2 bg-cyan-400 rounded-full animate-pulse"})]}),e.jsx("h3",{className:"text-white font-semibold text-lg",children:t.title}),e.jsx("p",{className:"text-gray-300 text-sm mt-2",children:t.message}),e.jsx("p",{className:"text-gray-500 text-xs mt-3",children:new Date(t.created_at).toLocaleString()})]}),e.jsxs("div",{className:"flex gap-2 ml-4 flex-shrink-0",children:[!t.is_read&&e.jsx("button",{onClick:()=>j(t.id),className:"p-2 text-gray-400 hover:text-cyan-400 transition rounded hover:bg-cyan-900/30",title:"Mark as read",children:e.jsx(E,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>v(t.id),className:"p-2 text-gray-400 hover:text-red-400 transition rounded hover:bg-red-900/30",title:"Delete",children:e.jsx(S,{className:"w-5 h-5"})})]})]})})},t.id))})]})}export{q as default};
